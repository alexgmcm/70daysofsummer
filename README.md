MRes Summer Project - Characterising the effect of normal brain ageing on MEG recordings: a diagnostic tool?
==========================================

File structure
-------------------
/channelinfo/ - contains files describing channel position
/Dissertation/ - contains the LaTeX files and pdf of the Dissertation itself and images incl. etc.
/featureVectors/ - contains the feature vectors (i.e. the processed data)
/misc/ - contains miscellaneous files, mostly the accompanying age/gender info to the MEG data
/programs/ - contains the MATLAB files and produced files divided into subdirectories
	/programs/pdfimages - contains the images of pdf format
	/programs/epsimages - contains the images of eps format
	/programs/bashscripts - contains miscellaneous bash scripts
	/programs/csvfiles - contains comma-separated value files exported from the .xls files in /misc/
	/programs/matfiles - contains .mat files generated by the MATLAB scripts
	/programs/mfiles - contains the MATLAB scripts
	/programs/pngfiles - contains the images of png format
/scpscripts/ - contains bash scripts used copy the data from the engineering server
/tsne/ - contains code for t-Distributed Stochastic Neighbour Embedding 


List of programs (contents of /programs/mfiles )
------------------------------------------------
applyWelch.m - function to calculate PSD's using Welch's method
bootstrapLRfit.m - function to perform bootstrap estimates of RMSE using residual values
copycorruptions.m - utility script to move corrupted data into separate directory
correctUnits.m - utility script to correct units for the data which were affected by Excel bug
createHealtyMetaData.m - gets age/gender info for healthy subjects
downsampleData.m - function to downsample data
fieldtripcode.m - load data into FieldTrip MATLAB package and process 
filechecking.m - check files against data records in .xls spreadsheets
findCorruptionsScript.m - find corruptions in the raw data files
finishFeatureVectors.m - second script to finish making the feature vectors
generateFeatureVectors.m - first script to start making the feature vectors
healthyRegressionScript.m - script containing regression model and classification code
importfile.m - generated script to import healthy data
importscript.m - obsolete code to import data 
insertrows.m - function to insert rows into matrix
interpolateCorruptions.m - unsuccessful attempt to fix corruptions by interpolation
interpolateSingleErrors.m - attempt to fix simpler case where file has only 1 corruption
kfoldCVLinearRegression.m - function to generate linear regression model using k-fold cross validation
loadAndRejectScript.m - script to load fieldtrip processed data and perform artefact rejection using fieldtrip
loadAndSegment.m - obsolete code that attempted to load into fieldtrip without header file
loadDiffFormat.m - function to load data files that were stored in different subdirectories
loadDiffFormatScript.m - script using above function
loadFieldTrip.m - function to load data into FieldTrip using the header file
loadMEGData.m - function to load MEG Data from raw data file
loadNormFormat.m - script to load data that was in the usual single file form
loadStructuredData.m - script to load data with extra info required by FieldTrip
rechazo_artefactos2.m - old script to do artefact detection without FieldTrip
regions_definitions.m - defines the brain regions in terms of the MEG channels
rejectArtefacts.m - English translation of rechazo_artefactos2.m with some improvements
run_rechazo.m - partner script to rechazo_artefactos2.m
stripFileExtension.m -function to strip file extension from filename
visualisationScript.m - script to perform data visualisations




Additional Notes
-------
Original raw data consists of time vector + 148 MEG channels, sampling rate is 169.549Hz except for 300mb files which are at 678.17Hz and require downsampling etc.

Alzheimers data has the same sampling rate.

Some of the data is corrupted - the corruptions are noted in filename,linenumber format in corruptions.txt, be careful not to attempt to load these lines - split the loading into bits before and after the line and then concatenate the matrices.

The data files which are ~300mb have not been downsampled, these should be low pass filtered and then take one of every 4 - the decimate function does this pretty much automatically, although it will not be identical to how the MEG hardware downsampled the others and so if the samples prove to be problematic in later analysis they should be discarded.

The channel position data is in channelinfo dir.

scpscripts dir contains commands used to copy data from master server

Amplitude of signals is usually below 1pT - units appear to be in fT

### Artefact rejection

rechazo_artefactos2.m is a rudimentary artefact rejection script that takes the signal as a whole, breaks it up into many little pieces and calculates the median maximum deviation from the mean then divides the signal into larger epochs and rejects any epoch with deviations larger than the median multiplied by some constant. This removes the ocular artefacts (i.e. blinking)

Cardiac artefact should be negligible for our purposes but can be removed by a clever process averaging over all signals and using ICA etc. if absolutely necessary

Note all signals should have the mean subtracted from them when they are loaded such that they are zero mean.

FieldTrip can do automated artefact rejection but requires the data to be loaded in the correct structure - attempted in importdata


### Filtering

Filtering should be done with a Hamming window, FIR filter with higher order (~500), filtfilt does two filters and thus avoids group delay so doesn't effect phase.

Band pass filter 1.5Hz tp 40Hz or 60Hz (if only to 40Hz then must use Notch Filter at 50Hz to remove Mains AC artefact)

fdatool in MATLAB can be used to design filters easily
